USE SAMAYFINAL;
#-------------------------------------------------------------
#CREATING TABLE
#-------------------------------------------------------------

#COUNTRY TABLE

CREATE TABLE `COUNTRY` (
  COUNTRY_ID int NOT NULL,
  COUNTRY_NAME varchar(10),
  COUNTRY_CODE int,
  CURRENCY_CODE varchar(15) ,
  CONTINENT_NAME varchar(10),
  PRIMARY KEY (COUNTRY_ID)
  );
  
  DROP TABLE COUNTRY;
  
#EVENT TABLE

DROP TABLE EVENT;
CREATE TABLE EVENT (
  EVENT_ID int NOT NULL,
  CUSTOMER_ID INT,
  EMPLOYEE_ID INT, 
  EVENT_IS VARCHAR(20),
  EVENT_HELD DATETIME NOT NULL,
  PRIMARY KEY (EVENT_ID),
   FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID),
   FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEE(EMP_ID))
   ;
  
#CUSTOMER TABLE

CREATE TABLE CUSTOMER
(
CUSTOMER_ID INT PRIMARY KEY,
COUNTRY_ID INT,
CUSTOMER_NAME VARCHAR(20),
COUNTRY_NAME VARCHAR(15),
FOREIGN KEY(COUNTRY_ID) REFERENCES COUNTRY(COUNTRY_ID)
);

#TIMEZONE TABLE

CREATE TABLE TIME_ZONE
(
TIMEZONE_ID INT,
COUNTRY_ID INT,
TIMEZONEE VARCHAR(20),
PRIMARY KEY(TIMEZONE_ID),
FOREIGN KEY(COUNTRY_ID) REFERENCES COUNTRY(COUNTRY_ID)
);  
DROP TABLE TIME_ZONE;

#EMPLOYEE TABLE

CREATE TABLE EMPLOYEE
(
EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(20),
COUNTRY_ID INT,
FOREIGN KEY(COUNTRY_ID) REFERENCES COUNTRY(COUNTRY_ID)
);

#-------------------------------------------------------------

#SELECT ALL

#-------------------------------------------------------------


#COUNTRY TABLE
SELECT * FROM COUNTRY;

#CUSTOMER TABLE 
SELECT * FROM CUSTOMER;

#TIMEZONE TABLE
SELECT * FROM TIME_ZONE;

#EMPLOYEE TABLE
SELECT * FROM EMPLOYEE;

#EVENTS TABLE

SELECT * FROM EVENT;


#-------------------------------------------------------------
#INSERTION 
#-------------------------------------------------------------


#COUNTRY TABLE COLUMNS

INSERT INTO COUNTRY VALUES (1,'INDIA',91,'INR','ASIA');
INSERT INTO COUNTRY VALUES (2,'SOUTHKOREA',82,'KRW','ASIA');
INSERT INTO COUNTRY VALUES (3,'JAPAN',81,'YEN','ASIA');
INSERT INTO COUNTRY VALUES (4,'BRAZIL',55,'BRL','SA');
INSERT INTO COUNTRY VALUES (5,'COLOMBIA',57,'COP','SA');
INSERT INTO COUNTRY VALUES (6,'DENMARK',45,'DKK','NEUROPE');

#CUSTOMER TABLE COLUMNS

INSERT INTO CUSTOMER VALUES(1,1,'TEJASWINI','INDIA' );
INSERT INTO CUSTOMER VALUES(2,2,'KIM HEE DO','SOUTHKOREA' );
INSERT INTO CUSTOMER VALUES(3,3,'JACKSON','JAPAN' );
INSERT INTO CUSTOMER VALUES(4,4,'LILLY','BRAZIL' );
INSERT INTO CUSTOMER VALUES(5,5,'TIM','COLOMBIA' );
INSERT INTO CUSTOMER VALUES(6,6,'ASHLEY','DENMARK' );

#EMPLOYEE COLUMNS

INSERT INTO EMPLOYEE VALUES(1,'ASHWITHA',1);
INSERT INTO EMPLOYEE VALUES(2,'KIM WOO BIN',2 );
INSERT INTO EMPLOYEE VALUES(3,'JOYLIN',3);
INSERT INTO EMPLOYEE VALUES(4,'LIAM',4 );
INSERT INTO EMPLOYEE VALUES(5,'TEENA',5 );
INSERT INTO EMPLOYEE VALUES(6,'ASH',6 );


#TIMEZONE TABLE COLUMNS

INSERT INTO TIME_ZONE VALUES( 1,1,'GMT+5.3');
INSERT INTO TIME_ZONE VALUES( 2,2,'GMT+9');
INSERT INTO TIME_ZONE VALUES( 3,3,'GMT+9');
INSERT INTO TIME_ZONE VALUES( 4,4,'GMT-5');
INSERT INTO TIME_ZONE VALUES( 5,5,'GMT-5');
INSERT INTO TIME_ZONE VALUES( 6,6,'GMT+1');

#EVENTS COLUMNS

INSERT INTO EVENT VALUES(1,1,1,'BIRTHDAY','2022-02-08');
INSERT INTO EVENT VALUES(2,2,2,'NEW YEAR','2022-03-01');
INSERT INTO EVENT VALUES(3,3,3,'WEDDING','2022-12-28');
INSERT INTO EVENT VALUES(4,4,4,'ENGAGEMENT','2022-10-18');
INSERT INTO EVENT VALUES(5,5,5,'OFFICE','2022-11-06');
INSERT INTO EVENT VALUES(6,6,6,'NEW YEAR','2022-01-01');


#-------------------------------------------------------------
#QUERIES
#-------------------------------------------------------------

#1) List of all employees attending an event on a specific date

SELECT DISTINCT EM.EMP_ID, EM.EMP_NAME,E.EVENT_HELD,E.EVENT_IS
FROM 
EMPLOYEE AS EM, EVENT AS E
WHERE EM.EMP_ID=E.EMPLOYEE_ID 
AND 
EVENT_HELD ='2022-10-18';


# 2) List of all customers in a particular country having events between 01-Jan-2022 and 31-Mar-2022.

SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME,E.EVENT_HELD,E.EVENT_IS
FROM 
CUSTOMER AS C, EVENT AS E
WHERE C.CUSTOMER_ID=E.CUSTOMER_ID 
AND 
EVENT_HELD BETWEEN '2022-01-01' AND '2022-03-01';

#3) List of all customers in a timezone which is GMT-5 hrs

SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME,C.COUNTRY_NAME,T.TIMEZONEE
FROM
CUSTOMER AS C, TIME_ZONE AS T
WHERE
C.COUNTRY_ID=T.COUNTRY_ID
AND
TIMEZONEE='GMT-5';

